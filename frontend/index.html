<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="AI-Driven Clinical Decision Support System for Hypertension Prediction" />
  <title>AI-Driven Hypertension Clinical Decision Support System</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>

  <!-- ========== HEADER ========== -->
  <header class="app-header">
    <div class="header-inner">
      <div class="header-brand">
        <svg class="header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
        </svg>
        <div>
          <h1 class="header-title">AI-Driven Hypertension Clinical Decision Support System</h1>
          <p class="header-subtitle">Decision Tree-Based Prediction Model</p>
        </div>
      </div>
      <div class="header-badge">CDSS v1.0</div>
    </div>
  </header>

  <!-- ========== MAIN CONTENT ========== -->
  <main class="main-content">

    <!-- Transient error banner (hidden by default) -->
    <div id="error-banner" class="error-banner" role="alert" hidden></div>

    <!-- Patient Input Form Card -->
    <section class="card card--form" aria-labelledby="form-heading">
      <div class="card-header">
        <svg class="card-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
          <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        </svg>
        <h2 id="form-heading" class="card-title">Patient Vital Parameters</h2>
      </div>
      <p class="card-description">Enter the patient's clinical measurements below. All fields are required for prediction.</p>

      <form id="prediction-form" class="form" novalidate>

        <!-- Age -->
        <div class="form-group">
          <label for="age" class="form-label">Age <span class="form-required" aria-label="required">*</span></label>
          <div class="input-wrapper">
            <input type="number" id="age" name="age" class="form-input" placeholder="e.g. 55" min="18" max="120" step="1" required aria-describedby="age-helper age-error" />
            <span class="input-unit">years</span>
          </div>
          <span id="age-helper" class="form-helper">Normal adult range: 18 &ndash; 120 years</span>
          <span id="age-error" class="form-error" role="alert"></span>
        </div>

        <!-- BMI -->
        <div class="form-group">
          <label for="bmi" class="form-label">BMI <span class="form-required" aria-label="required">*</span></label>
          <div class="input-wrapper">
            <input type="number" id="bmi" name="bmi" class="form-input" placeholder="e.g. 24.5" min="10" max="60" step="0.1" required aria-describedby="bmi-helper bmi-error" />
            <span class="input-unit">kg/m&sup2;</span>
          </div>
          <span id="bmi-helper" class="form-helper">Normal range: 18.5 &ndash; 24.9 kg/m&sup2;</span>
          <span id="bmi-error" class="form-error" role="alert"></span>
        </div>

        <!-- Cholesterol -->
        <div class="form-group">
          <label for="cholesterol" class="form-label">Cholesterol <span class="form-required" aria-label="required">*</span></label>
          <div class="input-wrapper">
            <input type="number" id="cholesterol" name="cholesterol" class="form-input" placeholder="e.g. 200" min="50" max="500" step="1" required aria-describedby="cholesterol-helper cholesterol-error" />
            <span class="input-unit">mg/dL</span>
          </div>
          <span id="cholesterol-helper" class="form-helper">Desirable: &lt; 200 mg/dL</span>
          <span id="cholesterol-error" class="form-error" role="alert"></span>
        </div>

        <!-- Systolic Blood Pressure -->
        <div class="form-group">
          <label for="systolic" class="form-label">Systolic Blood Pressure <span class="form-required" aria-label="required">*</span></label>
          <div class="input-wrapper">
            <input type="number" id="systolic" name="systolic" class="form-input" placeholder="e.g. 120" min="60" max="250" step="1" required aria-describedby="systolic-helper systolic-error" />
            <span class="input-unit">mmHg</span>
          </div>
          <span id="systolic-helper" class="form-helper">Normal: &lt; 120 mmHg</span>
          <span id="systolic-error" class="form-error" role="alert"></span>
        </div>

        <!-- Diastolic Blood Pressure -->
        <div class="form-group">
          <label for="diastolic" class="form-label">Diastolic Blood Pressure <span class="form-required" aria-label="required">*</span></label>
          <div class="input-wrapper">
            <input type="number" id="diastolic" name="diastolic" class="form-input" placeholder="e.g. 80" min="30" max="160" step="1" required aria-describedby="diastolic-helper diastolic-error" />
            <span class="input-unit">mmHg</span>
          </div>
          <span id="diastolic-helper" class="form-helper">Normal: &lt; 80 mmHg</span>
          <span id="diastolic-error" class="form-error" role="alert"></span>
        </div>

        <!-- Submit Button -->
        <div class="form-actions">
        <button type="submit" id="predict-btn" class="btn btn--primary" disabled>
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="11" cy="11" r="8"/>
            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
          </svg>
          <span id="predict-btn-text">Predict Hypertension Risk</span>
        </button>

        <!-- Reset button clears the form and hides results -->
        <button type="button" id="reset-btn" class="btn btn--secondary">
          <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <polyline points="1 4 1 10 7 10"/>
            <path d="M3.51 15a9 9 0 1 0 .49-4.5"/>
          </svg>
          Reset Form
        </button>
        </div>

      </form>
    </section>

    <!-- Results Section (hidden by default) -->
    <section id="results-section" class="card card--results" hidden aria-labelledby="results-heading">
      <div class="card-header">
        <svg class="card-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M9 11l3 3L22 4"/>
          <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
        </svg>
        <h2 id="results-heading" class="card-title">Prediction Results</h2>
      </div>

      <!-- Result Card -->
      <div id="result-card" class="result-card">
        <div class="result-card-header">
          <span id="result-icon" class="result-icon" aria-hidden="true"></span>
          <h3 id="result-text" class="result-text"></h3>
        </div>
        <div class="result-details">
          <div class="result-confidence">
            <span class="result-confidence-label">
              Confidence Score
              <button type="button" class="info-icon" aria-label="Confidence info" aria-describedby="confidence-tooltip">&#9432;</button>
              <span id="confidence-tooltip" class="info-tooltip" role="tooltip">Confidence reflects model certainty, not clinical certainty.</span>
            </span>
            <div class="confidence-bar-wrapper">
              <div id="confidence-bar" class="confidence-bar">
                <div id="confidence-bar-fill" class="confidence-bar-fill"></div>
              </div>
              <span id="confidence-value" class="confidence-value"></span>
              <span id="confidence-band" class="confidence-band"></span>
            </div>
          </div>
          <!-- BP Classification Badge -->
          <div class="result-bp-row">
            <span class="result-confidence-label">Blood Pressure Class</span>
            <span id="bp-category-badge" class="bp-badge">--</span>
          </div>

          <!-- Raw Risk Score -->
          <div class="result-bp-row">
            <span class="result-confidence-label">Weighted Risk Score</span>
            <span id="risk-score-value" class="risk-score-num">--</span><span class="risk-score-unit">&thinsp;/ 100</span>
          </div>

          <!-- Flagged Risk Factors -->
          <div class="risk-factors">
            <span class="result-confidence-label">Flagged Risk Factors</span>
            <ul id="risk-factors-list" class="risk-factors-list"></ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Clinical Interpretation Panel (shown after prediction) -->
    <section id="clinical-interpretation" class="card card--interpretation" hidden aria-labelledby="ci-heading">
      <div class="card-header">
        <svg class="card-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <path d="M12 20h9"/>
          <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z"/>
        </svg>
        <h2 id="ci-heading" class="card-title">Clinical Interpretation</h2>
      </div>
      <p class="card-description">Summary of the key factors driving this prediction.</p>

      <div id="ci-card" class="ci-card">
        <!-- Primary Decision Driver -->
        <div class="ci-row">
          <span class="ci-label">Primary Decision Driver</span>
          <span id="ci-primary-driver" class="ci-value ci-value--primary">—</span>
        </div>

        <!-- Secondary Risk Factors -->
        <div class="ci-row ci-row--col">
          <span class="ci-label">Secondary Risk Factors</span>
          <ul id="ci-secondary-list" class="ci-factor-list">
            <li class="ci-factor--none">No additional risk factors identified.</li>
          </ul>
        </div>

        <!-- Confidence -->
        <div class="ci-row">
          <span class="ci-label">
            Model Confidence
            <button type="button" class="info-icon" aria-label="Confidence info" aria-describedby="ci-confidence-desc">&#9432;</button>
            <span id="ci-confidence-desc" class="info-tooltip" role="tooltip">Confidence reflects model certainty, not clinical certainty.</span>
          </span>
          <span id="ci-confidence" class="ci-value ci-value--confidence">—</span>
          <span id="ci-confidence-band" class="confidence-band"></span>
        </div>
      </div>
    </section>

    <!-- Session History Table (hidden until first prediction) -->
    <section id="history-section" class="card card--history" hidden aria-labelledby="history-heading">
      <div class="card-header">
        <svg class="card-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <rect x="3" y="3" width="18" height="18" rx="2"/>
          <line x1="3" y1="9" x2="21" y2="9"/>
          <line x1="3" y1="15" x2="21" y2="15"/>
          <line x1="9" y1="9" x2="9" y2="21"/>
        </svg>
        <h2 id="history-heading" class="card-title">Session Prediction History</h2>
      </div>
      <p class="card-description">All predictions made during this browser session. Cleared on page reload.</p>
      <div class="table-scroll">
        <table class="history-table" aria-label="Prediction history">
          <thead>
            <tr>
              <th>#</th>
              <th>Age</th>
              <th>BMI</th>
              <th>Cholesterol</th>
              <th>BP (Sys/Dia)</th>
              <th>BP Class</th>
              <th>Prediction</th>
              <th>Confidence</th>
            </tr>
          </thead>
          <tbody id="history-tbody">
            <tr id="history-empty-row">
              <td colspan="8" class="history-empty">No predictions yet in this session.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

  </main>

  <!-- ========== FOOTER ========== -->
  <footer class="app-footer">
    <p class="footer-text">&#x26A0;&#xFE0F; For academic demonstration only. Not a substitute for professional medical advice.</p>
    <p class="footer-credit">Biomedical Engineering &mdash; Clinical Decision Support System</p>
  </footer>

  <!-- ========== SCRIPTS ========== -->
  <script src="js/validators.js"></script>
  <script src="js/api.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/app.js"></script>

</body>
</html>
